(function(){"use strict";var e={4060:function(e,t,r){var a=r(9242),o=r(3396);function i(e,t,r,a,i,s){const l=(0,o.up)("header-component"),n=(0,o.up)("router-view"),c=(0,o.up)("footer-component");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{productSending:i.productSending},null,8,["productSending"]),(0,o.Wm)(n,{onProductSending:t[0]||(t[0]=e=>i.productSending=e),cartLoading:i.cartLoading},null,8,["cartLoading"]),(0,o.Wm)(c)],64)}const s={class:"header container"},l={class:"header__wrapper"},n=(0,o._)("span",{class:"header__info"},"Каталог",-1),c=(0,o._)("img",{src:"img/svg/logo-moire.svg",alt:"Логотип интернет магазина Moire",width:"116",height:"34"},null,-1),d=(0,o._)("a",{class:"header__tel",href:"tel:8 800 600 90 09"}," 8 800 600 90 09 ",-1);function u(e,t,r,a,i,u){const p=(0,o.up)("router-link"),m=(0,o.up)("cart-indicator");return(0,o.wg)(),(0,o.iD)("header",s,[(0,o._)("div",l,[n,(0,o.Wm)(p,{class:"header__logo",to:{name:"main"}},{default:(0,o.w5)((()=>[c])),_:1}),d,(0,o.Wm)(m,{productSending:r.productSending},null,8,["productSending"])])])}var p=r(7139);const m=e=>((0,o.dD)("data-v-9fdb122a"),e=e(),(0,o.Cn)(),e),_={class:"cart-indicator-wrap"},h=m((()=>(0,o._)("svg",{width:"19",height:"24",fill:"currentColor"},[(0,o._)("use",{"xlink:href":"#icon-cart"})],-1))),g={key:1,class:"header__count","aria-label":"Количество товаров"};function f(e,t,r,a,i,s){const l=(0,o.up)("base-preloader"),n=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",_,[(0,o.Wm)(n,{class:"header__cart","aria-label":"Корзина с товарами",to:{name:"cart"}},{default:(0,o.w5)((()=>[h,r.productSending?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"cart-indicator-preloader"})):((0,o.wg)(),(0,o.iD)("span",g,(0,p.zw)(e.countProducts),1))])),_:1})])}var y=r(65),b=r.p+"img/Spinner-2.6d3c0ed1.gif";const v={class:"spinner",src:b,alt:"Загрузка количества товаров ..."};function w(e,t){return(0,o.wg)(),(0,o.iD)("img",v)}var I=r(89);const k={},P=(0,I.Z)(k,[["render",w]]);var C=P,D={components:{BasePreloader:C},props:{productSending:Boolean},computed:{...(0,y.Se)({countProducts:"cartCountProducts"})}};const S=(0,I.Z)(D,[["render",f],["__scopeId","data-v-9fdb122a"]]);var z=S,T={name:"HeaderComponent",components:{CartIndicator:z},props:{productSending:Boolean}};const A=(0,I.Z)(T,[["render",u]]);var M=A;const N={class:"footer container"},F={class:"footer__wrapper"},U={class:"footer__links"},K=(0,o._)("li",null,[(0,o._)("a",{class:"footer__link",href:"tel:88006009009"}," 8 800 600 90 09 ")],-1),O=(0,o._)("li",null,[(0,o._)("a",{class:"footer__link",href:"mailto:hi@technozavrrr.com"}," hi@technozavrrr.com ")],-1),q=(0,o._)("li",null,[(0,o._)("a",{class:"footer__link",href:"#"}," Распродажа ")],-1),x=(0,o._)("li",null,[(0,o._)("a",{class:"footer__link footer__link--medium",href:"#"}," Заказать звонок ")],-1),Z={class:"footer__social social"},H=["aria-label"],W=["width","height"],E=["xlink:href"],$=(0,o.uE)('<p class="footer__desc"> Все права на материалы, находящиеся на сайте, охраняются в соответствии с законодательством РФ, в том числе об авторском праве и смежных правах. </p><ul class="footer__data"><li><a class="footer__link" href="#" target="_blank" rel="noopener" type="application/pdf"> Политика конфиденциальности </a></li><li><a class="footer__link" href="#" target="_blank" rel="noopener" type="application/pdf"> Публичная оферта </a></li></ul><span class="footer__copyright"> © 2020 Moire </span>',3);function L(e,t,r,a,i,s){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("footer",N,[(0,o._)("div",F,[(0,o._)("ul",U,[(0,o._)("li",null,[(0,o.Wm)(l,{class:"footer__link",to:{name:"main"}},{default:(0,o.w5)((()=>[(0,o.Uk)(" Каталог ")])),_:1})]),K,O,q,x]),(0,o._)("ul",Z,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.socialIcons,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"social__item",key:e.href},[(0,o._)("a",{class:"social__link",href:"#","aria-label":e.title},[((0,o.wg)(),(0,o.iD)("svg",{width:e.width,height:e.height,fill:"currentColor"},[(0,o._)("use",{"xlink:href":e.href},null,8,E)],8,W))],8,H)])))),128))]),$])])}var j={name:"FooterComponent",data(){return{socialIcons:[{title:"Вконтакте",href:"#icon-vk",width:20,height:11},{title:"Инстаграм",href:"#icon-insta",width:17,height:17},{title:"Facebook",href:"#icon-facebook",width:17,height:17},{title:"Twitter",href:"#icon-twitter",width:17,height:14},{title:"Telegram",href:"#icon-telegram",width:19,height:17}]}}};const B=(0,I.Z)(j,[["render",L]]);var Y=B,V={name:"App",components:{HeaderComponent:M,FooterComponent:Y},data(){return{productSending:!1,cartLoading:!0}},created(){const e=localStorage.getItem("userAccessKey");e&&this.updateUserAccessKey(e),this.loadCart().then((()=>{this.cartLoading=!1}))},methods:{...(0,y.nv)(["loadCart"]),...(0,y.OI)(["updateUserAccessKey"])}};const G=(0,I.Z)(V,[["render",i]]);var Q=G;const J=e=>((0,o.dD)("data-v-73fc81fa"),e=e(),(0,o.Cn)(),e),R={class:"content container"},X={class:"content__top"},ee={class:"content__row"},te=J((()=>(0,o._)("h1",{class:"content__title"},"Каталог",-1))),re={class:"content__info"},ae={class:"content__catalog"},oe={key:0,class:"catalog spinner-wrap"},ie={key:1,class:"catalog error-message spinner-wrap"},se={key:2,class:"catalog"};function le(e,t,r,i,s,l){const n=(0,o.up)("quantity-switch"),c=(0,o.up)("product-filter"),d=(0,o.up)("base-preloader"),u=(0,o.up)("product-list"),m=(0,o.up)("base-pagination");return(0,o.wg)(),(0,o.iD)("main",R,[(0,o._)("div",X,[(0,o._)("div",ee,[te,(0,o._)("span",re,"Всего товаров: "+(0,p.zw)(e.countProducts),1),(0,o.Wm)(n,{"products-per-page":e.productsPerPage,onChangeQuantityPerPage:e.changeProductsPerPage},null,8,["products-per-page","onChangeQuantityPerPage"])])]),(0,o._)("div",ae,[(0,o.Wm)(c,{"price-from":e.filterPriceFrom,"onUpdate:priceFrom":t[0]||(t[0]=t=>e.filterPriceFrom=t),"price-to":e.filterPriceTo,"onUpdate:priceTo":t[1]||(t[1]=t=>e.filterPriceTo=t),"category-id":e.filterCategoryId,"onUpdate:categoryId":t[2]||(t[2]=t=>e.filterCategoryId=t),"color-ids":e.filterColorIds,"onUpdate:colorIds":t[3]||(t[3]=t=>e.filterColorIds=t),"material-ids":e.filterMaterialIds,"onUpdate:materialIds":t[4]||(t[4]=t=>e.filterMaterialIds=t),"season-ids":e.filterSeasonIds,"onUpdate:seasonIds":t[5]||(t[5]=t=>e.filterSeasonIds=t),"change-page-title-by-id":e.changePageTitleById,"onUpdate:changePageTitleById":t[6]||(t[6]=t=>e.changePageTitleById=t)},null,8,["price-from","price-to","category-id","color-ids","material-ids","season-ids","change-page-title-by-id"]),e.productsLoading?((0,o.wg)(),(0,o.iD)("section",oe,[(0,o.Wm)(d,{class:"spinner"})])):e.productsLoadingFailed?((0,o.wg)(),(0,o.iD)("section",ie,[(0,o.Uk)(" Произошла ошибка при загрузке товаров "),(0,o._)("button",{onClick:t[7]||(t[7]=(0,a.iM)(((...t)=>e.loadProducts&&e.loadProducts(...t)),["prevent"]))},"Попробовать ещё раз")])):((0,o.wg)(),(0,o.iD)("section",se,[(0,o.Wm)(u,{products:e.products,onProductSending:t[8]||(t[8]=t=>e.productSending=t)},null,8,["products"]),e.products.length>0?((0,o.wg)(),(0,o.j4)(m,{key:0,count:e.countProducts,modelValue:e.page,"onUpdate:modelValue":t[9]||(t[9]=t=>e.page=t),"per-page":e.productsPerPage},null,8,["count","modelValue","per-page"])):(0,o.kq)("",!0)]))])])}const ne={key:0,class:"catalog__list"},ce={key:1};function de(e,t,r,a,i,s){const l=(0,o.up)("product-item");return r.products.length>0?((0,o.wg)(),(0,o.iD)("div",ne,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.products,(e=>((0,o.wg)(),(0,o.j4)(l,{onProductSending:t[0]||(t[0]=e=>i.productSending=e),product:e,key:e.id},null,8,["product"])))),128))])):((0,o.wg)(),(0,o.iD)("div",ce,"Ничего не найдено"))}const ue={class:"catalog__item"},pe={key:0,class:"cart__error form__error-block add-message"},me=["src","alt"],_e={class:"catalog__title"},he={class:"catalog__price"},ge={class:"btn-spinner-wrap",key:"one"},fe=["disabled"];function ye(e,t,r,i,s,l){const n=(0,o.up)("router-link"),c=(0,o.up)("colors-list"),d=(0,o.up)("base-preloader");return(0,o.wg)(),(0,o.iD)("article",ue,[(0,o.Wm)(a.uT,{name:"mode-fade"},{default:(0,o.w5)((()=>[s.showMessage?((0,o.wg)(),(0,o.iD)("div",pe,[(0,o._)("h4",null,(0,p.zw)(s.message),1)])):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(n,{class:"catalog__pic",to:{name:"product",params:{id:r.product.id}}},{default:(0,o.w5)((()=>[(0,o._)("img",{ref:"preview",src:r.product.defaultImage,alt:r.product.title},null,8,me)])),_:1},8,["to"]),(0,o._)("h3",_e,[(0,o.Wm)(n,{to:{name:"product",params:{id:r.product.id}}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,p.zw)(r.product.title),1)])),_:1},8,["to"])]),(0,o._)("span",he,(0,p.zw)(r.product.price)+" ₽ ",1),(0,o._)("form",{class:"form",action:"#",method:"POST",onSubmit:t[0]||(t[0]=(0,a.iM)(((...e)=>l.addToCart&&l.addToCart(...e)),["prevent"]))},[(0,o.Wm)(c,{colors:r.product.colors,onSelectColor:l.selectColor},null,8,["colors","onSelectColor"]),(0,o.Wm)(a.uT,{name:"mode-fade",mode:"out-in"},{default:(0,o.w5)((()=>[s.productAddSending?((0,o.wg)(),(0,o.iD)("div",ge,[(0,o.Wm)(d,{class:"btn-spinner"})])):((0,o.wg)(),(0,o.iD)("button",{class:"button button--primery mini-button",type:"submit",disabled:s.productAddSending,key:"two"}," В корзину ",8,fe))])),_:1})],32)])}const be={key:0,class:"colors colors--black"},ve=["title"],we=["value","onClick"];function Ie(e,t,r,a,i,s){return e.colors.length?((0,o.wg)(),(0,o.iD)("ul",be,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.colors,(t=>((0,o.wg)(),(0,o.iD)("li",{class:"colors__item",key:t.color.id},[(0,o._)("label",{class:"colors__label",title:t.color.title},[(0,o._)("input",{class:"colors__radio sr-only",type:"radio",name:"color",value:t,onClick:r=>e.$emit("selectColor",t)},null,8,we),(0,o._)("span",{class:"colors__value",style:(0,p.j5)({backgroundColor:t.color.code,border:"1px solid #999"})},null,4)],8,ve)])))),128))])):(0,o.kq)("",!0)}var ke=(0,o.aZ)({name:"ColorsList",props:{colors:{type:Array,required:!0}},data(){return{colorObj:null}},emits:["selectColor"]});const Pe=(0,I.Z)(ke,[["render",Ie]]);var Ce=Pe,De=r(4161);const Se="Каталог",ze="Корзина",Te="https://vue-moire.skillbox.cc",Ae=Te+"/api/products/",Me=12,Ne="/moire";var Fe={components:{ColorsList:Ce,BasePreloader:C},props:{product:{type:Object,required:!0}},data(){return{selectedColor:null,selectedSizeId:0,showMessage:!1,productAddSending:!1,message:""}},emits:["productSending"],watch:{selectedColor(e){e.gallery&&(this.$refs.preview.src=e.gallery[0]?.file?.url,this.selectedColorGallery=e.gallery)}},mounted(){this.selectedColor=this.product.colors[0]},methods:{...(0,y.nv)(["addProductToCart"]),async addToCart(){this.showMessage=!1,this.updatePreloaderStatus(!0);const e=await this.loadProductSize();this.addProductToCart({productId:this.product.id,colorId:this.selectedColor.color.id,sizeId:e,amount:1}).then((()=>{this.message="Товар добавлен в корзину"})).catch((e=>{this.message="Произошла ошибка",console.error(e)})).finally((()=>{this.showMessage=!0,this.updatePreloaderStatus(!1),setTimeout((()=>{this.showMessage=!1}),1e3)}))},selectColor(e){this.selectedColor=e},async loadProductSize(){this.productLoading=!0,this.productLoadingFailed=!1;const e=await De.Z.get(Ae+this.product.id);return e.data.sizes[0].id},updatePreloaderStatus(e){this.productAddSending=e,this.$emit("productSending",this.productAddSending)}}};const Ue=(0,I.Z)(Fe,[["render",ye],["__scopeId","data-v-dd84b4c0"]]);var Ke=Ue,Oe={components:{ProductItem:Ke},props:{products:{type:Array,required:!0}},data(){return{productSending:!1}},emits:["productSending"],watch:{productSending(){this.$emit("productSending",this.productSending)}}};const qe=(0,I.Z)(Oe,[["render",de]]);var xe=qe;const Ze={class:"catalog__pagination pagination"},He={class:"pagination__item"},We=(0,o._)("svg",{width:"8",height:"14",fill:"currentColor"},[(0,o._)("use",{"xlink:href":"#icon-arrow-left"})],-1),Ee=[We],$e=["onClick"],Le={class:"pagination__item"},je=(0,o._)("svg",{width:"8",height:"14",fill:"currentColor"},[(0,o._)("use",{"xlink:href":"#icon-arrow-right"})],-1),Be=[je];function Ye(e,t,r,i,s,l){return(0,o.wg)(),(0,o.iD)("ul",Ze,[(0,o._)("li",He,[(0,o._)("a",{href:"#",class:(0,p.C_)(["pagination__link pagination__link--arrow",{"pagination__link--disabled":1===l.page}]),onClick:t[0]||(t[0]=(0,a.iM)((e=>l.paginate(l.page-1)),["prevent"])),"aria-label":"Предыдущая страница"},Ee,2)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.pages,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"pagination__item",key:e},[(0,o._)("a",{href:"#",class:(0,p.C_)(["pagination__link",{"pagination__link--current":e===l.page}]),onClick:(0,a.iM)((t=>l.paginate(e)),["prevent"])},(0,p.zw)(e),11,$e)])))),128)),(0,o._)("li",Le,[(0,o._)("a",{href:"#",class:(0,p.C_)(["pagination__link pagination__link--arrow",{"pagination__link--disabled":l.page===l.pages}]),onClick:t[1]||(t[1]=(0,a.iM)((e=>l.paginate(l.page+1)),["prevent"])),"aria-label":"Следующая страница"},Be,2)])])}var Ve={props:{modelValue:{type:Number,required:!0},count:{type:Number,required:!0},perPage:{type:Number,required:!0}},computed:{pages(){return Math.ceil(this.count/this.perPage)},page(){return this.modelValue}},methods:{paginate(e){e>0&&e<=this.pages&&this.$emit("update:modelValue",e)}}};const Ge=(0,I.Z)(Ve,[["render",Ye]]);var Qe=Ge;const Je=e=>((0,o.dD)("data-v-62407e81"),e=e(),(0,o.Cn)(),e),Re={class:"filter"},Xe=Je((()=>(0,o._)("h2",{class:"filter__title"},"Фильтры",-1))),et={class:"form__block"},tt=Je((()=>(0,o._)("legend",{class:"form__legend"},"Цена",-1))),rt={class:"form__label form__label--price"},at=Je((()=>(0,o._)("span",{class:"form__value"},"От",-1))),ot={class:"form__label form__label--price"},it=Je((()=>(0,o._)("span",{class:"form__value"},"До",-1))),st={class:"form__block"},lt=Je((()=>(0,o._)("legend",{class:"form__legend"},"Категория",-1))),nt={class:"form__label form__label--select"},ct=Je((()=>(0,o._)("option",{value:"0"},"Все категории",-1))),dt=["value"],ut={class:"form__block"},pt=Je((()=>(0,o._)("legend",{class:"form__legend"},"Цвет",-1))),mt={class:"colors"},_t=["title"],ht=["value"],gt={class:"form__block"},ft=Je((()=>(0,o._)("legend",{class:"form__legend"},"Материал",-1))),yt={class:"check-list"},bt=["title"],vt=["value"],wt={class:"check-list__desc"},It={class:"form__block"},kt=Je((()=>(0,o._)("legend",{class:"form__legend"},"Коллекция",-1))),Pt={class:"check-list"},Ct={class:"check-list__label"},Dt=["value"],St={class:"check-list__desc"},zt=Je((()=>(0,o._)("button",{class:"filter__submit button button--primery",type:"submit"}," Применить ",-1)));function Tt(e,t,r,i,s,l){return(0,o.wg)(),(0,o.iD)("aside",Re,[Xe,(0,o._)("form",{class:"filter__form form",action:"#",method:"get",onSubmit:t[7]||(t[7]=(0,a.iM)(((...e)=>l.submit&&l.submit(...e)),["prevent"]))},[(0,o._)("fieldset",et,[tt,(0,o._)("label",rt,[(0,o.wy)((0,o._)("input",{class:"form__input",type:"text",name:"min-price","onUpdate:modelValue":t[0]||(t[0]=e=>s.currentPriceFrom=e)},null,512),[[a.nr,s.currentPriceFrom,void 0,{number:!0}]]),at]),(0,o._)("label",ot,[(0,o.wy)((0,o._)("input",{class:"form__input",type:"text",name:"max-price","onUpdate:modelValue":t[1]||(t[1]=e=>s.currentPriceTo=e)},null,512),[[a.nr,s.currentPriceTo,void 0,{number:!0}]]),it])]),(0,o._)("fieldset",st,[lt,(0,o._)("label",nt,[(0,o.wy)((0,o._)("select",{class:"form__select",name:"category","onUpdate:modelValue":t[2]||(t[2]=e=>s.currentCategoryId=e)},[ct,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.categories,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e.id,key:e.id},(0,p.zw)(e.title),9,dt)))),128))],512),[[a.bM,s.currentCategoryId,void 0,{number:!0}]])])]),(0,o._)("fieldset",ut,[pt,(0,o._)("ul",mt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.allColors,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"colors__item",key:e.id},[(0,o._)("label",{class:"colors__label",title:e.title},[(0,o.wy)((0,o._)("input",{class:"colors__radio sr-only",type:"checkbox",name:"selectedColors",value:e.id,"onUpdate:modelValue":t[3]||(t[3]=e=>s.currentColorIds=e)},null,8,ht),[[a.e8,s.currentColorIds]]),(0,o._)("span",{class:"colors__value",style:(0,p.j5)({backgroundColor:e.code,border:"1px solid #999"})},null,4)],8,_t)])))),128))])]),(0,o._)("fieldset",gt,[ft,(0,o._)("ul",yt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.allMaterials,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"check-list__item",key:e.id},[(0,o._)("label",{class:"check-list__label",title:e.title},[(0,o.wy)((0,o._)("input",{class:"check-list__check sr-only",type:"checkbox",name:"material",value:e.id,"onUpdate:modelValue":t[4]||(t[4]=e=>s.currentMaterialIds=e)},null,8,vt),[[a.e8,s.currentMaterialIds]]),(0,o._)("span",wt,[(0,o.Uk)((0,p.zw)(e.title)+" ",1),(0,o._)("span",null,"("+(0,p.zw)(e.productsCount)+")",1)])],8,bt)])))),128))])]),(0,o._)("fieldset",It,[kt,(0,o._)("ul",Pt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.allSeasons,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"check-list__item",key:e.id},[(0,o._)("label",Ct,[(0,o.wy)((0,o._)("input",{class:"check-list__check sr-only",type:"checkbox",name:"collection",value:e.id,"onUpdate:modelValue":t[5]||(t[5]=e=>s.currentSeasonIds=e)},null,8,Dt),[[a.e8,s.currentSeasonIds]]),(0,o._)("span",St,[(0,o.Uk)((0,p.zw)(e.title)+" ",1),(0,o._)("span",null,"("+(0,p.zw)(e.productsCount)+")",1)])])])))),128))])]),zt,s.isFilterSubmitted?((0,o.wg)(),(0,o.iD)("button",{key:0,class:"filter__reset button button--second",type:"button",onClick:t[6]||(t[6]=(0,a.iM)(((...e)=>l.reset&&l.reset(...e)),["prevent"]))}," Сбросить ")):(0,o.kq)("",!0)],32)])}const At=Te+"/api/productCategories",Mt=Te+"/api/colors",Nt=Te+"/api/materials",Ft=Te+"/api/seasons",Ut=(e,t)=>{let r="";return!!t&&(r=e.find((e=>e.id===t)).title,document.title=Se+" | "+r,!0)};var Kt={props:{priceFrom:{type:[Number,String],required:!0},priceTo:{type:[Number,String],required:!0},categoryId:{type:Number,required:!0},colorIds:{type:Array,required:!0},materialIds:{type:Array,required:!0},seasonIds:{type:Array,required:!0},changePageTitleById:Number},data(){return{isFilterSubmitted:!1,currentPriceFrom:0,currentPriceTo:0,currentCategoryId:0,currentColorIds:[],currentMaterialIds:[],currentSeasonIds:[],categoriesData:null,allColorsData:null,allMaterialsData:null,allSeasonsData:null}},computed:{categories(){const e=this.categoriesData?this.categoriesData.items:[];return e},allColors(){return this.allColorsData?this.allColorsData.items:[]},allMaterials(){return this.allMaterialsData?this.allMaterialsData.items:[]},allSeasons(){return this.allSeasonsData?this.allSeasonsData.items:[]}},created(){this.loadCategories(),this.loadAllColors(),this.loadAllMaterials(),this.loadAllSeasons()},methods:{submit(){this.isFilterSubmitted=!0,this.$emit("update:priceFrom",this.currentPriceFrom),this.$emit("update:priceTo",this.currentPriceTo),this.$emit("update:categoryId",this.currentCategoryId),this.$emit("update:colorIds",this.currentColorIds),this.$emit("update:materialIds",this.currentMaterialIds),this.$emit("update:seasonIds",this.currentSeasonIds),Ut(this.categoriesData.items,this.currentCategoryId)},reset(){this.currentPriceFrom=0,this.currentPriceTo=0,this.currentCategoryId=0,this.currentColorIds=[],this.currentMaterialIds=[],this.currentSeasonIds=[],this.submit(),this.isFilterSubmitted=!1,document.title=Se},loadCategories(){De.Z.get(At).then((e=>{this.categoriesData=e.data,Ut(this.categoriesData.items,this.changePageTitleById)&&(this.currentCategoryId=this.changePageTitleById,this.submit())}))},loadAllColors(){De.Z.get(Mt).then((e=>{this.allColorsData=e.data,localStorage.setItem("allColorsData",JSON.stringify(this.allColorsData))}))},loadAllMaterials(){De.Z.get(Nt).then((e=>{this.allMaterialsData=e.data}))},loadAllSeasons(){De.Z.get(Ft).then((e=>{this.allSeasonsData=e.data}))}}};const Ot=(0,I.Z)(Kt,[["render",Tt],["__scopeId","data-v-62407e81"]]);var qt=Ot;const xt=Ne+"/img/default.jpg",Zt=(e=null,t=0)=>{let r="";const a=e?.colors[t]?.gallery;return Array.isArray(a)&&a.length>0&&(r=a[0].file?.url),r||(r=xt),r},Ht=e=>{for(const t in e)if(e.hasOwnProperty(t))return!1;return!0},Wt=e=>{const{productId:t,colorId:r,sizeId:a}=e;return`${t}-${r}-${a}`},Et={class:"quantity-switch"},$t=["onClick"];function Lt(e,t,r,a,i,s){return(0,o.wg)(),(0,o.iD)("div",Et,[(0,o.Uk)(" Количество товаров на странице:   "),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.quantitySwitch,(e=>((0,o.wg)(),(0,o.iD)("button",{class:(0,p.C_)(["quantity-switch__item button--primery",{"quantity-switch__item--active":r.productsPerPage==e.quantity}]),key:e.quantity,onClick:t=>s.changeQuantity(e.quantity)},(0,p.zw)(e.quantity),11,$t)))),128))])}var jt={props:{productsPerPage:{type:Number}},emits:["changeQuantityPerPage"],data(){return{quantitySwitch:[{quantity:6},{quantity:9},{quantity:Me}]}},methods:{changeQuantity(e){this.$emit("changeQuantityPerPage",e)}}};const Bt=(0,I.Z)(jt,[["render",Lt],["__scopeId","data-v-13bd6c9d"]]);var Yt=Bt,Vt=(0,o.aZ)({components:{ProductList:xe,BasePagination:Qe,ProductFilter:qt,BasePreloader:C,QuantitySwitch:Yt},data(){return{filterPriceFrom:0,filterPriceTo:0,filterCategoryId:0,filterColorIds:[],filterMaterialIds:[],filterSeasonIds:[],changePageTitleById:0,page:1,productsPerPage:Me,productsData:null,categoriesData:null,productsLoading:!1,productsLoadingFailed:!1,productSending:!1}},emits:["productSending"],computed:{products(){return this.productsData?this.productsData.items.map((e=>({...e,defaultImage:Zt(e)}))):[]},countProducts(){return this.productsData?this.productsData.pagination.total:0}},watch:{page(){this.loadProducts()},filterPriceFrom(){this.loadProducts()},filterPriceTo(){this.loadProducts()},filterCategoryId(){this.loadProducts()},filterColorIds(){this.loadProducts()},filterMaterialIds(){this.loadProducts()},filterSeasonIds(){this.loadProducts()},productSending(){this.$emit("productSending",this.productSending)}},created(){this.doFilterByCategory(),this.loadProducts()},methods:{loadProducts(){this.productsLoading=!0,this.productsLoadingFailed=!1,De.Z.get(Ae,{params:{page:this.page,limit:this.productsPerPage,minPrice:this.filterPriceFrom,maxPrice:this.filterPriceTo,categoryId:this.filterCategoryId,colorIds:this.filterColorIds,materialIds:this.filterMaterialIds,seasonIds:this.filterSeasonIds}}).then((e=>{this.productsData=e.data})).catch((()=>this.productsLoadingFailed=!0)).then((()=>this.productsLoading=!1))},doFilterByCategory(){const e=+this.$route.params.id;"category"===this.$route.name&&(this.filterCategoryId=e,this.changePageTitleById=+e)},changeProductsPerPage(e){this.productsPerPage=e,this.loadProducts()}}});const Gt=(0,I.Z)(Vt,[["render",le],["__scopeId","data-v-73fc81fa"]]);var Qt=Gt;const Jt=e=>((0,o.dD)("data-v-2cc47948"),e=e(),(0,o.Cn)(),e),Rt={key:0,class:"content container spinner-wrap"},Xt={key:1,class:"content container"},er={key:2,class:"content container"},tr={class:"content__top"},rr={class:"item"},ar={class:"item__pics pics"},or={class:"pics__wrapper"},ir=["src","alt"],sr={class:"pics__list"},lr=["src","alt"],nr={class:"item__info"},cr={class:"item__code"},dr={class:"item__title"},ur={class:"item__form"},pr={class:"item__row item__row--center product-price"},mr={class:"item__price"},_r={class:"form__block product-param"},hr=Jt((()=>(0,o._)("legend",{class:"form__legend"},"Цвет:",-1))),gr={class:"form__block product-param product-param--last"},fr=Jt((()=>(0,o._)("legend",{class:"form__legend"},"Размер",-1))),yr={class:"form__label form__label--small form__label--select"},br=["value"],vr={class:"btn-spinner-wrap",key:"one"},wr=["disabled"],Ir={class:"item__desc"},kr={class:"tabs"},Pr=["href","onClick"],Cr=["id"];function Dr(e,t,r,i,s,l){const n=(0,o.up)("base-preloader"),c=(0,o.up)("bread-crumbs"),d=(0,o.up)("form-counter"),u=(0,o.up)("colors-list"),m=(0,o.up)("message-modal");return e.productStatus.isLoading?((0,o.wg)(),(0,o.iD)("main",Rt,[(0,o.Wm)(n,{class:"spinner"})])):e.productStatus.isFailed?((0,o.wg)(),(0,o.iD)("main",Xt,[(0,o.Uk)(" Не удалось загрузить товар "),(0,o._)("button",{onClick:t[0]||(t[0]=(0,a.iM)((t=>e.fetchProduct(e.$route.params.id)),["prevent"]))}," Попробовать ещё раз ")])):((0,o.wg)(),(0,o.iD)("main",er,[(0,o._)("div",tr,[(0,o.Wm)(c,{"bread-crumbs":e.breadCrumbs},null,8,["bread-crumbs"])]),(0,o._)("section",rr,[(0,o._)("div",ar,[(0,o._)("div",or,[(0,o._)("img",{ref:"preview",width:"570",height:"570",src:e.product.defaultImage,alt:e.product.title},null,8,ir)]),(0,o._)("ul",sr,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.selectedColorGallery,(t=>((0,o.wg)(),(0,o.iD)("li",{class:"pics__item",key:t.id},[(0,o._)("img",{width:"98",height:"98",src:t?.file?.url,alt:e.product.title},null,8,lr)])))),128))])]),(0,o._)("div",nr,[(0,o._)("span",cr,"Артикул: "+(0,p.zw)(e.itemNumber),1),(0,o._)("h2",dr,(0,p.zw)(e.product.title),1),(0,o._)("div",ur,[(0,o._)("form",{class:"form",action:"#",method:"POST",onSubmit:t[3]||(t[3]=(0,a.iM)(((...t)=>e.addToCart&&e.addToCart(...t)),["prevent"]))},[(0,o._)("div",pr,[(0,o.Wm)(d,{onUpdateInput:e.updateInput},null,8,["onUpdateInput"]),(0,o._)("b",mr,(0,p.zw)(e.product.price)+" ₽ ",1)]),(0,o._)("fieldset",_r,[hr,(0,o.Wm)(u,{colors:e.product.colors,onSelectColor:e.selectColor},null,8,["colors","onSelectColor"])]),(0,o._)("fieldset",gr,[fr,(0,o._)("label",yr,[(0,o.wy)((0,o._)("select",{class:"form__select",name:"category","onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedSizeId=t)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.product.sizes,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e.id,key:e.id},(0,p.zw)(e.title),9,br)))),128))],512),[[a.bM,e.selectedSizeId]])])]),(0,o.Wm)(a.uT,{name:"mode-fade",mode:"out-in"},{default:(0,o.w5)((()=>[e.isProductAddSending?((0,o.wg)(),(0,o.iD)("div",vr,[(0,o.Wm)(n,{class:"btn-spinner"})])):((0,o.wg)(),(0,o.iD)("button",{class:"item__button button button--primery",type:"submit",disabled:e.isProductAddSending,key:"two"}," В корзину ",8,wr))])),_:1}),(0,o.Wm)(m,{open:e.isShowMessage,"onUpdate:open":t[2]||(t[2]=t=>e.isShowMessage=t)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,p.zw)(e.message),1)])),_:1},8,["open"])],32)])]),(0,o._)("div",Ir,[(0,o._)("ul",kr,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.tabs,(t=>((0,o.wg)(),(0,o.iD)("li",{class:"tabs__item",key:t.id},[(0,o._)("a",{href:t.href,"active-class":"tabs__link--current",class:(0,p.C_)(["tabs__link",{"tabs__link--current":e.activeTabId===t.id}]),onClick:(0,a.iM)((r=>e.activeTabId=t.id),["prevent"])},(0,p.zw)(t.title),11,Pr)])))),128))]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.tabs,(t=>(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{id:t.id,class:"item__content",key:t.id},(0,p.zw)(t.content),9,Cr)),[[a.F8,e.activeTabId===t.id]]))),128))])])]))}const Sr=(0,o._)("svg",{width:"12",height:"12",fill:"currentColor"},[(0,o._)("use",{"xlink:href":"#icon-minus"})],-1),zr=[Sr],Tr=["value"],Ar=(0,o._)("svg",{width:"12",height:"12",fill:"currentColor"},[(0,o._)("use",{"xlink:href":"#icon-plus"})],-1),Mr=[Ar];function Nr(e,t,r,a,i,s){return(0,o.wg)(),(0,o.iD)("div",{class:(0,p.C_)(["form__counter",r.wrapCssClass])},[(0,o._)("button",{type:"button","aria-label":"Убрать один товар",onClick:t[0]||(t[0]=(...e)=>s.deleteOne&&s.deleteOne(...e))},zr),(0,o._)("input",{type:"text",name:"count",value:i.amount,onInput:t[1]||(t[1]=e=>s.updateInput(e.target.value))},null,40,Tr),(0,o._)("button",{type:"button","aria-label":"Добавить один товар",onClick:t[2]||(t[2]=(...e)=>s.addOne&&s.addOne(...e))},Mr)],2)}var Fr={props:{wrapCssClass:{type:String,default:""},itemCount:{type:Number,default:1}},data(){return{amount:1}},emits:["updateInput"],watch:{amount(e){e<1&&(this.amount=1)}},created(){this.amount=this.itemCount},methods:{updateInput(e){e<1&&(e=1),this.$emit("updateInput",e)},deleteOne(){this.updateInput(--this.amount)},addOne(){this.updateInput(++this.amount)}}};const Ur=(0,I.Z)(Fr,[["render",Nr]]);var Kr=Ur;const Or={class:"breadcrumbs"},qr={class:"breadcrumbs__item"},xr={key:1};function Zr(e,t,r,a,i,s){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("ul",Or,[(0,o._)("li",qr,[(0,o.Wm)(l,{class:"breadcrumbs__link",to:{name:"main"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,p.zw)(e.pageMainTitle),1)])),_:1})]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.breadCrumbs,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"breadcrumbs__item",key:e.text},[e.routeName?((0,o.wg)(),(0,o.j4)(l,{key:0,class:"breadcrumbs__link",to:{name:e.routeName,params:{id:e.paramId??null}}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,p.zw)(e.text),1)])),_:2},1032,["to"])):((0,o.wg)(),(0,o.iD)("div",xr,(0,p.zw)(e.text),1))])))),128))])}var Hr=(0,o.aZ)({props:{breadCrumbs:{type:Array,required:!0}},data(){return{pageMainTitle:Se}}});const Wr=(0,I.Z)(Hr,[["render",Zr]]);var Er=Wr,$r=r(4870),Lr=r(2483);function jr(){const e=(0,$r.iH)(null),t=(0,$r.iH)(null),r=(0,$r.iH)(null),a=(0,$r.iH)(0),i=(0,$r.iH)(document.title),s=(0,$r.iH)([{id:"info",href:"#info",title:"Информация о товаре",content:"Информации нет"},{id:"delivery",href:"#delivery",title:"Доставка и возврат",content:"Описано на странице корзины"}]),l=(0,o.Fl)((()=>e.value.category)),n=e=>{for(const t of s.value)if("info"===t.id&&e)return void(t.content=e)},c=(0,$r.iH)(""),d=(0,$r.qj)({isLoading:!1,isFailed:!1}),u=o=>{d.isLoading=!0,d.isFailed=!1,De.Z.get(Ae+o).then((o=>{e.value=Object.assign(o.data,{defaultImage:Zt(o.data)}),t.value=e.value.colors[0],r.value=e.value.colors[0].gallery,a.value=e.value.sizes[0].id,i.value=e.value.title,document.title=i.value,c.value=Wt({productId:e.value.id,colorId:t.value.id,sizeId:a.value}),n(e.value.content)})).catch((()=>{d.isFailed=!0})).finally((()=>{d.isLoading=!1}))};return{product:e,category:l,fetchProduct:u,status:d,selectedColor:t,selectedColorGallery:r,selectedSizeId:a,pageTitle:i,tabs:s,itemNumber:c}}var Br=(0,o.aZ)({components:{FormCounter:Kr,BreadCrumbs:Er,BasePreloader:C,ColorsList:Ce,MessageModal:(0,o.RC)({loader:()=>r.e(784).then(r.bind(r,784)),delay:0})},setup(e,{emit:t}){const r=(0,Lr.yj)(),a=(0,y.oR)(),{product:i,category:s,fetchProduct:l,status:n,selectedColor:c,selectedColorGallery:d,selectedSizeId:u,pageTitle:p,tabs:m,itemNumber:_}=jr(),h=(0,$r.iH)(1),g=e=>{h.value=e},f=(0,$r.iH)(!1),b=(0,$r.iH)(""),v=(0,$r.iH)(!1),w=e=>{f.value=e,t("productSending",f.value)},I=e=>{c.value=e},k=()=>{v.value=!1,w(!0),h.value>0&&a.dispatch("addProductToCart",{productId:i.value.id,colorId:c.value.color.id,sizeId:u.value,amount:h.value}).then((()=>{b.value="Товар добавлен в корзину"})).catch((e=>{b.value="Произошла ошибка",console.error(e)})).finally((()=>{v.value=!0,w(!1)}))},P=(0,$r.iH)([]),C=(0,$r.iH)(null);(0,o.YP)(c,(()=>{C.value&&(C.value.src=c.value.gallery[0]?.file?.url),d.value=c.value.gallery}));const D=(0,$r.iH)("info"),S=(0,o.Fl)((()=>[{paramId:s.value.id,text:s.value.title,routeName:"category"},{text:p.value,routeName:null}]));return l(r.params.id),(0,Lr.ao)((()=>{l(r.params.id)})),{pageTitle:p,productAmount:h,productStatus:n,isProductAddSending:f,message:b,isShowMessage:v,colorIds:P,selectedColor:c,selectedColorGallery:d,selectedSizeId:u,activeTabId:D,tabs:m,product:i,category:s,breadCrumbs:S,addToCart:k,updateInput:g,selectColor:I,preview:C,fetchProduct:l,itemNumber:_}}});const Yr=(0,I.Z)(Br,[["render",Dr],["__scopeId","data-v-2cc47948"]]);var Vr=Yr;const Gr=e=>((0,o.dD)("data-v-d2872468"),e=e(),(0,o.Cn)(),e),Qr={class:"content container"},Jr={class:"content__top"},Rr={class:"content__row"},Xr={class:"content__title"},ea={class:"content__info"},ta={class:"cart"},ra={class:"cart__form form",action:"#",method:"POST"},aa={class:"cart__field"},oa={key:1,class:"cart__list"},ia={key:2},sa=Gr((()=>(0,o._)("h3",null,"Корзина пуста",-1))),la=Gr((()=>(0,o._)("button",{class:"button button--primery btn-link"}," В каталог ",-1))),na={class:"cart__block"},ca=Gr((()=>(0,o._)("p",{class:"cart__desc"}," Мы посчитаем стоимость доставки на следующем этапе ",-1))),da={class:"cart__price"},ua=Gr((()=>(0,o._)("button",{class:"cart__button button button--primery",type:"submit"}," Оформить заказ ",-1)));function pa(e,t,r,i,s,l){const n=(0,o.up)("bread-crumbs"),c=(0,o.up)("base-preloader"),d=(0,o.up)("cart-item"),u=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("main",Qr,[(0,o._)("div",Jr,[(0,o.Wm)(n,{"bread-crumbs":l.breadCrumbs},null,8,["bread-crumbs"]),(0,o._)("div",Rr,[(0,o._)("h1",Xr,(0,p.zw)(s.pageTitle),1),(0,o._)("span",ea,"Всего товаров: "+(0,p.zw)(e.countProducts),1)])]),(0,o._)("section",ta,[(0,o._)("form",ra,[(0,o._)("div",aa,[r.cartLoading?((0,o.wg)(),(0,o.j4)(c,{key:0,class:"btn-spinner"})):e.items.length>0?((0,o.wg)(),(0,o.iD)("ul",oa,[(0,o.Wm)(a.W3,{name:"list"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.items,(e=>((0,o.wg)(),(0,o.j4)(d,{key:e.basketItemId,item:e},null,8,["item"])))),128))])),_:1})])):((0,o.wg)(),(0,o.iD)("div",ia,[sa,(0,o._)("div",null,[(0,o.Wm)(u,{to:{name:"main"}},{default:(0,o.w5)((()=>[la])),_:1})])]))]),(0,o._)("div",na,[ca,(0,o._)("p",da,[(0,o.Uk)(" Итого: "),(0,o._)("span",null,(0,p.zw)(e.totalPrice)+" ₽",1)]),e.items.length?((0,o.wg)(),(0,o.j4)(u,{key:0,to:{name:"order"}},{default:(0,o.w5)((()=>[ua])),_:1})):(0,o.kq)("",!0)]),e.items.length?((0,o.wg)(),(0,o.iD)("button",{key:0,class:"filter__reset button button--second cart-clear",type:"button",onClick:t[0]||(t[0]=(0,a.iM)(((...e)=>l.reset&&l.reset(...e)),["prevent"]))}," Очистить корзину ")):(0,o.kq)("",!0)])])])])}const ma=e=>((0,o.dD)("data-v-6548440c"),e=e(),(0,o.Cn)(),e),_a={class:"cart__item product"},ha={class:"product__pic"},ga=["src","alt"],fa={class:"product__title"},ya={class:"product__info product__info--color"},ba={class:"product-size"},va={class:"product__code"},wa={class:"product__price"},Ia=ma((()=>(0,o._)("svg",{width:"20",height:"20",fill:"currentColor"},[(0,o._)("use",{"xlink:href":"#icon-close"})],-1))),ka=[Ia];function Pa(e,t,r,a,i,s){const l=(0,o.up)("form-counter");return(0,o.wg)(),(0,o.iD)("li",_a,[(0,o._)("div",ha,[(0,o._)("img",{src:r.item.product.defaultImage,width:"120",height:"120",alt:r.item.product.title},null,8,ga)]),(0,o._)("h3",fa,(0,p.zw)(r.item.product.title),1),(0,o._)("p",ya,[(0,o.Uk)(" Цвет: "),(0,o._)("span",null,[(0,o._)("i",{style:(0,p.j5)({backgroundColor:s.currentColor.code,border:"1px solid #999"})},null,4),(0,o.Uk)(" "+(0,p.zw)(s.currentColor.title),1)])]),(0,o._)("span",ba," Размер: "+(0,p.zw)(r.item.sizeTitle),1),(0,o._)("span",va," Артикул: "+(0,p.zw)(r.item.itemNumber),1),(0,o.Wm)(l,{"wrap-css-class":"product__counter","item-count":r.item.amount,onUpdateInput:s.updateInput},null,8,["item-count","onUpdateInput"]),(0,o._)("b",wa,(0,p.zw)(s.itemPrice)+" ₽ ",1),(0,o._)("button",{class:"product__del button-del",type:"button","aria-label":"Удалить товар из корзины",onClick:t[0]||(t[0]=t=>e.deleteProduct(r.item.basketItemId))},ka)])}var Ca={components:{FormCounter:Kr},props:{item:{type:Object,required:!0}},computed:{itemPrice(){return this.item.amount*this.item.product.price},amount:{get(){return this.item.amount},set(e){this.$store.dispatch("updateCartProductAmount",{basketItemId:this.item.basketItemId,productId:this.item.productId,colorId:this.item.colorId,sizeId:this.item.sizeId,amount:e})}},allColors(){const e=JSON.parse(localStorage.getItem("allColorsData")).items;return e},currentColor(){return this.allColors.find((e=>e.id===this.item.colorId))}},methods:{...(0,y.nv)({deleteProduct:"deleteProductFromCart"}),updateInput(e){this.amount=e}}};const Da=(0,I.Z)(Ca,[["render",Pa],["__scopeId","data-v-6548440c"]]);var Sa=Da,za={components:{CartItem:Sa,BreadCrumbs:Er,BasePreloader:C},props:{cartLoading:Boolean},data(){return{pageTitle:ze,pageMainTitle:Se}},computed:{...(0,y.Se)({items:"cartDetailProducts",totalPrice:"cartTotalPrice",countProducts:"cartCountProducts"}),breadCrumbs(){return[{text:ze,routeName:null}]}},methods:{reset(){this.items.forEach((e=>{this.$store.dispatch("deleteProductFromCart",e.basketItemId)}))}}};const Ta=(0,I.Z)(za,[["render",pa],["__scopeId","data-v-d2872468"]]);var Aa=Ta;const Ma={class:"content container"},Na=(0,o._)("h1",null,"Страница не найдена",-1),Fa=[Na];function Ua(e,t){return(0,o.wg)(),(0,o.iD)("main",Ma,Fa)}const Ka={},Oa=(0,I.Z)(Ka,[["render",Ua]]);var qa=Oa;const xa=e=>((0,o.dD)("data-v-ad6b0754"),e=e(),(0,o.Cn)(),e),Za={class:"content container"},Ha={class:"content__top"},Wa={class:"content__row"},Ea={class:"content__title"},$a={class:"cart"},La={class:"cart__field"},ja={class:"cart__data"},Ba=["onUpdate:modelValue","type","placeholder"],Ya={class:"form__value"},Va={key:0,class:"form__error"},Ga={class:"form__label"},Qa=xa((()=>(0,o._)("span",{class:"form__value"},"Комментарий к заказу",-1))),Ja={key:0,class:"form__error"},Ra={class:"cart__options"},Xa=xa((()=>(0,o._)("h3",{class:"cart__title"},"Доставка",-1))),eo={class:"cart__options options"},to={class:"options__label"},ro=["value"],ao={class:"options__value"},oo=xa((()=>(0,o._)("h3",{class:"cart__title"},"Оплата",-1))),io={name:"list",class:"cart__options options"},so={class:"options__label"},lo=["value"],no={class:"options__value"},co=xa((()=>(0,o._)("button",{class:"cart__button button button--primery",type:"submit"}," Оформить заказ ",-1))),uo={key:0,class:"cart__error form__error-block"},po=xa((()=>(0,o._)("h4",null,"Заявка не отправлена!",-1))),mo=xa((()=>(0,o._)("p",null," Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу. ",-1)));function _o(e,t,r,i,s,l){const n=(0,o.up)("bread-crumbs"),c=(0,o.up)("base-preloader"),d=(0,o.up)("cart-order-block");return(0,o.wg)(),(0,o.iD)("main",Za,[(0,o._)("div",Ha,[(0,o.Wm)(n,{"bread-crumbs":l.breadCrumbs},null,8,["bread-crumbs"]),(0,o._)("div",Wa,[(0,o._)("h1",Ea,(0,p.zw)(s.pageTitle),1)])]),(0,o._)("section",$a,[(0,o._)("form",{class:"cart__form form",action:"#",method:"POST",onSubmit:t[3]||(t[3]=(0,a.iM)(((...e)=>l.doOrderSubmit&&l.doOrderSubmit(...e)),["prevent"]))},[(0,o._)("div",La,[(0,o._)("div",ja,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.formInputs,(e=>((0,o.wg)(),(0,o.iD)("label",{class:"form__label",key:e.propName},[(0,o.wy)((0,o._)("input",{class:"form__input","onUpdate:modelValue":t=>s.formData[e.propName]=t,type:e.type,placeholder:e.placeholder},null,8,Ba),[[a.YZ,s.formData[e.propName]]]),(0,o._)("span",Ya,(0,p.zw)(e.title),1),s.formError[e.propName]?((0,o.wg)(),(0,o.iD)("span",Va,(0,p.zw)(s.formError[e.propName]),1)):(0,o.kq)("",!0)])))),128)),(0,o._)("label",Ga,[(0,o.wy)((0,o._)("textarea",{class:"form__input form__input--area","onUpdate:modelValue":t[0]||(t[0]=e=>s.formData.comment=e),placeholder:"Ваши пожелания"},null,512),[[a.nr,s.formData.comment]]),Qa,s.formError.comment?((0,o.wg)(),(0,o.iD)("span",Ja,(0,p.zw)(s.formError.comment),1)):(0,o.kq)("",!0)])]),(0,o._)("div",Ra,[Xa,(0,o._)("ul",eo,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.orderDeliveries,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"options__item",key:e.id},[(0,o._)("label",to,[(0,o.wy)((0,o._)("input",{class:"options__radio sr-only",type:"radio",name:"delivery",checked:"",value:e.id,"onUpdate:modelValue":t[1]||(t[1]=e=>s.pickedDeliveryId=e)},null,8,ro),[[a.G2,s.pickedDeliveryId]]),(0,o._)("span",ao,[(0,o.Uk)((0,p.zw)(e.title)+" ",1),(0,o._)("b",null,(0,p.zw)(+e.price>0?e.price+" ₽":"бесплатно"),1)])])])))),128))]),oo,(0,o._)("ul",io,[(0,o.Wm)(a.W3,{name:"list"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.payments,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"options__item",key:e.id},[(0,o._)("label",so,[(0,o.wy)((0,o._)("input",{class:"options__radio sr-only",type:"radio",name:"pay",checked:"",value:e.id,"onUpdate:modelValue":t[2]||(t[2]=e=>s.pickedPaymentId=e)},null,8,lo),[[a.G2,s.pickedPaymentId]]),(0,o._)("span",no,(0,p.zw)(e.title),1)])])))),128))])),_:1})])])]),(0,o.Wm)(a.uT,{name:"mode-fade",mode:"out-in"},{default:(0,o.w5)((()=>[s.orderSending?((0,o.wg)(),(0,o.j4)(c,{key:"one"})):((0,o.wg)(),(0,o.j4)(d,{key:1,items:e.items,deliveryPrice:s.deliveryPrice,countProducts:e.countProducts,totalPrice:e.totalPrice},{default:(0,o.w5)((()=>[co])),_:1},8,["items","deliveryPrice","countProducts","totalPrice"]))])),_:1}),(0,o.Wm)(a.uT,{name:"mode-fade"},{default:(0,o.w5)((()=>[s.formErrorMessage?((0,o.wg)(),(0,o.iD)("div",uo,[po,mo,(0,o._)("p",null,(0,p.zw)(s.formErrorMessage),1)])):(0,o.kq)("",!0)])),_:1})],32)])])}r(7658);const ho={class:"cart__block",key:"two"},go={class:"cart__orders"},fo={class:"cart__total"};function yo(e,t,r,a,i,s){return(0,o.wg)(),(0,o.iD)("div",ho,[(0,o._)("ul",go,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.items,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.productId,class:"cart__order"},[(0,o._)("h3",null,(0,p.zw)(e.product.title),1),(0,o._)("b",null,(0,p.zw)((e.amount||e.quantity)*e.product.price)+" ₽",1),(0,o._)("span",null,"Артикул: "+(0,p.zw)(e.itemNumber||s.doGetItemNumber(e)),1),(0,o._)("span",null,"Размер: "+(0,p.zw)(e.sizeTitle||e.size.title),1)])))),128))]),(0,o._)("div",fo,[(0,o._)("p",null,[(0,o.Uk)(" Доставка: "),(0,o._)("b",null,(0,p.zw)(r.deliveryPrice),1)]),(0,o._)("p",null,[(0,o.Uk)(" Итого: "),(0,o._)("b",null,(0,p.zw)(r.countProducts),1),(0,o.Uk)(" товара на сумму "),(0,o._)("b",null,(0,p.zw)(r.totalPrice)+" ₽",1)])]),(0,o.WI)(e.$slots,"default")])}var bo={props:{items:{type:Array},deliveryPrice:{type:String},countProducts:{type:Number},totalPrice:{type:Number}},methods:{doGetItemNumber(e){return Wt({productId:e.product.id,colorId:e.color.id,sizeId:e.size.id})}}};const vo=(0,I.Z)(bo,[["render",yo]]);var wo=vo;const Io="290 ₽";var ko={components:{BreadCrumbs:Er,BasePreloader:C,CartOrderBlock:wo},data(){return{pageTitle:document.title,orderSending:!1,deliveryPrice:Io,pickedDeliveryId:2,pickedPaymentId:2,payments:[],formData:{deliveryTypeId:2,paymentTypeId:2},formError:{},formErrorMessage:"",formInputs:[{propName:"name",title:"ФИО",type:"text",placeholder:"Введите ваше полное имя"},{propName:"address",title:"Адрес доставки",type:"text",placeholder:"Введите ваш адрес"},{propName:"phone",title:"Телефон",type:"tel",placeholder:"Введите ваш телефон"},{propName:"email",title:"Email",type:"email",placeholder:"Введите ваш Email"}]}},computed:{...(0,y.Se)({items:"cartDetailProducts",totalPrice:"cartTotalPrice",countProducts:"cartCountProducts"}),breadCrumbs(){return[{text:ze,routeName:"cart"},{text:this.pageTitle,routeName:null}]},orderDeliveries(){return this.$store.state.deliveries}},watch:{pickedDeliveryId(e){this.formData.deliveryTypeId=e,this.updatePayments(e),this.pickedPaymentId=e},pickedPaymentId(e){this.formData.paymentTypeId=e},deliveryPrice(e){const t=parseFloat(e);t<=0&&(this.deliveryPrice="бесплатно")}},async created(){await this.$store.dispatch("loadDeliveries"),this.updatePayments(this.pickedDeliveryId)},methods:{checkForm(){const e="Поле не должно быть пустым";return this.formData.name||(this.formError.name=e),this.formData.address||(this.formError.address=e),this.formData.phone||(this.formError.phone=e),/^\S+@\S+\.\S+$/.test(this.formData.email)||(this.formError.email="Неправильный email"),this.formData.email||(this.formError.email=e),!!Ht(this.formError)||(this.orderSending=!1,!1)},doOrderSubmit(){this.formError={},this.orderSending=!0,this.checkForm()&&(this.formErrorMessage="",this.$store.dispatch("createOrder",this.formData).then((e=>{this.$router.push({name:"orderInfo",params:{id:e.data.id}})})).catch((e=>{const t=e.response.data.error;this.formError=t.request||{},this.formErrorMessage=t.message})).finally((()=>{this.orderSending=!1})))},async updatePayments(e){await this.$store.dispatch("loadPayments",e),this.payments=this.$store.state.payments,this.updateDeliveryPrice()},updateDeliveryPrice(){this.deliveryPrice=this.orderDeliveries.find((e=>e.id==this.pickedDeliveryId)).price+" ₽"}}};const Po=(0,I.Z)(ko,[["render",_o],["__scopeId","data-v-ad6b0754"]]);var Co=Po;const Do={class:"content container"},So={class:"content__top"},zo={class:"content__title"},To={class:"cart"},Ao={class:"cart__form form"},Mo={class:"cart__field"},No=(0,o._)("p",{class:"cart__message"}," Благодарим за выбор нашего магазина. На Вашу почту придет письмо с деталями заказа. Наши менеджеры свяжутся с Вами в течение часа для уточнения деталей доставки. ",-1),Fo={class:"dictionary"},Uo={class:"dictionary__key"},Ko={class:"dictionary__value"};function Oo(e,t,r,a,i,s){const l=(0,o.up)("bread-crumbs"),n=(0,o.up)("cart-order-block");return(0,o.wg)(),(0,o.iD)("main",Do,[(0,o._)("div",So,[(0,o.Wm)(l,{"bread-crumbs":s.breadCrumbs},null,8,["bread-crumbs"]),(0,o._)("h1",zo,[(0,o.Uk)(" Заказ оформлен "),(0,o._)("span",null,"№ "+(0,p.zw)(i.order?.id),1)])]),(0,o._)("section",To,[(0,o._)("div",Ao,[(0,o._)("div",Mo,[No,(0,o._)("ul",Fo,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.dictionaryList,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"dictionary__item",key:e.property},[(0,o._)("span",Uo,(0,p.zw)(e.title),1),(0,o._)("span",Ko,(0,p.zw)(i.order?.[e.property]),1)])))),128))])]),(0,o.Wm)(n,{items:s.items,deliveryPrice:s.deliveryPrice,countProducts:s.countProducts,totalPrice:s.totalPrice},null,8,["items","deliveryPrice","countProducts","totalPrice"])])])])}var qo={components:{BreadCrumbs:Er,CartOrderBlock:wo},data(){return{pageTitle:document.title,dictionaryList:[{property:"name",title:"Получатель"},{property:"address",title:"Адрес доставки"},{property:"phone",title:"Телефон"},{property:"email",title:"Email"},{property:"paymentType",title:"Способ оплаты"}],order:null}},computed:{items(){return this.order?.basket?.items},deliveryPrice(){return this.order?.deliveryType?.price>0?this.order?.deliveryType?.price+" ₽":"бесплатно"},totalPrice(){return this.order?.totalPrice},countProducts(){return this.order?.basket?.items?.length},breadCrumbs(){return[{text:ze,routeName:"cart"},{text:this.pageTitle,routeName:null}]}},async created(){await this.$store.dispatch("loadOrderInfo",this.$route.params.id),this.order=this.$store.state.orderInfo}};const xo=(0,I.Z)(qo,[["render",Oo]]);var Zo=xo;const Ho=[{path:"/",name:"main",component:Qt,meta:{title:Se}},{path:"/category/:id",name:"category",component:Qt,meta:{title:Se}},{path:"/product/:id",name:"product",component:Vr},{path:"/cart/",name:"cart",component:Aa,meta:{title:ze}},{path:"/order/",name:"order",component:Co,meta:{title:"Оформление заказа"}},{path:"/order/:id",name:"orderInfo",component:Zo,meta:{title:"Заказ оформлен"}},{path:"/:pathMatch(.*)*",name:"notFound",component:qa,meta:{title:"Not found"}}],Wo=(0,Lr.p7)({routes:Ho,history:(0,Lr.r5)(Ne)});Wo.beforeEach(((e,t,r)=>{e.path=Ne+e.path,document.title=e.meta.title||Se,r()}));var Eo=Wo;const $o=Te+"/api/baskets",Lo=Te+"/api/baskets/products",jo=Te+"/api/deliveries",Bo=Te+"/api/payments",Yo=Te+"/api/orders",Vo=e=>{e.cartProducts=e.cartProductsData.map((e=>({itemNumber:Wt({productId:e.product.id,colorId:e.color.id,sizeId:e.size.id}),productId:e.product.id,colorId:e.color.color.id,sizeId:e.size.id,amount:e.quantity})))};var Go=(0,y.MT)({state:{cartProducts:[],userAccessKey:null,cartProductsData:[],orderInfo:null,deliveries:null,payments:null},mutations:{updateOrderInfo(e,t){e.orderInfo=t},resetCart(e){e.cartProducts=[],e.cartProductsData=[]},updateCartProductAmount(e,{productId:t,colorId:r,sizeId:a,amount:o}){const i=e.cartProducts.find((e=>e.productId===t&&e.colorId===r&&e.sizeId===a));i&&(i.colorId=r,i.sizeId=a,i.amount=o)},deleteCartProduct(e,t){e.cartProductsData=e.cartProductsData.filter((e=>e.id!==t)),Vo(e)},updateUserAccessKey(e,t){e.userAccessKey=t},updateCartProductsData(e,t){e.cartProductsData=t},syncCartProducts(e){Vo(e)},updateDeliveries(e,t){e.deliveries=t},updatePayments(e,t){e.payments=t}},getters:{cartDetailProducts(e){const t=[],r=e.cartProducts.map((r=>{const a=e.cartProductsData.find((e=>e.product?.id===r.productId&&!t.includes(e.id)));let o={};if(a){t.push(a.id);const e=a?.product;o={basketItemId:a?.id,sizeTitle:a?.size.title,...r,product:{...e,defaultImage:Zt(e)}}}return o}));return r},cartTotalPrice(e,t){const r=t.cartDetailProducts.reduce(((e,t)=>t.product.price*t.amount+e),0);return r},cartCountProducts(e){return e.cartProducts.length}},actions:{async loadOrderInfo(e,t){const r=await De.Z.get(Yo+"/"+t,{params:{userAccessKey:e.state.userAccessKey}});e.commit("updateOrderInfo",r.data)},async loadCart(e){const t=await De.Z.get($o,{params:{userAccessKey:e.state.userAccessKey}});e.state.userAccessKey||(localStorage.setItem("userAccessKey",t.data.user.accessKey),e.commit("updateUserAccessKey",t.data.user.accessKey)),e.commit("updateCartProductsData",t.data.items),e.commit("syncCartProducts")},async addProductToCart(e,{productId:t,colorId:r,sizeId:a,amount:o}){return await new Promise((e=>setTimeout(e,500))),await De.Z.post(Lo,{productId:t,colorId:r,sizeId:a,quantity:o},{params:{userAccessKey:e.state.userAccessKey}}).then((t=>{localStorage.setItem("userAccessKey",t.data.user.accessKey),e.commit("updateCartProductsData",t.data.items),e.commit("syncCartProducts")}))},async updateCartProductAmount(e,{basketItemId:t,productId:r,colorId:a,sizeId:o,amount:i}){if(e.commit("updateCartProductAmount",{productId:r,colorId:a,sizeId:o,amount:i}),!(i<1))try{const r=await De.Z.put(Lo,{basketItemId:t,quantity:i},{params:{userAccessKey:e.state.userAccessKey}});e.commit("updateCartProductsData",r.data.items)}catch{e.commit("syncCartProducts")}},async deleteProductFromCart(e,t){const r=await De.Z.delete(Lo,{params:{userAccessKey:e.state.userAccessKey},data:{basketItemId:t}});return e.commit("deleteCartProduct",t),r},async loadDeliveries(e){const t=await De.Z.get(jo);e.commit("updateDeliveries",t.data)},async loadPayments(e,t){const r=await De.Z.get(Bo,{params:{deliveryTypeId:t}});e.commit("updatePayments",r.data)},async createOrder(e,t){const r=await De.Z.post(Yo,{...t},{params:{userAccessKey:e.state.userAccessKey}});return e.commit("resetCart"),e.commit("updateOrderInfo",r.data),r}}});const Qo=(0,a.ri)(Q);Qo.use(Eo),Qo.use(Go),Qo.mount("#app")}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,a,o,i){if(!a){var s=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],i=e[d][2];for(var l=!0,n=0;n<a.length;n++)(!1&i||s>=i)&&Object.keys(r.O).every((function(e){return r.O[e](a[n])}))?a.splice(n--,1):(l=!1,i<s&&(s=i));if(l){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,o,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,a){return r.f[a](e,t),t}),[]))}}(),function(){r.u=function(e){return"js/"+e+".dbcc7d08.js"}}(),function(){r.miniCssF=function(e){return"css/"+e+".4ca7a9b0.css"}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="final_examination_vue:";r.l=function(a,o,i,s){if(e[a])e[a].push(o);else{var l,n;if(void 0!==i)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+i){l=u;break}}l||(n=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.setAttribute("data-webpack",t+i),l.src=a),e[a]=[o];var p=function(t,r){l.onerror=l.onload=null,clearTimeout(m);var o=e[a];if(delete e[a],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach((function(e){return e(r)})),t)return t(r)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),n&&document.head.appendChild(l)}}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p="/moire/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,r,a,o){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var s=function(r){if(i.onerror=i.onload=null,"load"===r.type)a();else{var s=r&&("load"===r.type?"missing":r.type),l=r&&r.target&&r.target.href||t,n=new Error("Loading CSS chunk "+e+" failed.\n("+l+")");n.code="CSS_CHUNK_LOAD_FAILED",n.type=s,n.request=l,i.parentNode&&i.parentNode.removeChild(i),o(n)}};return i.onerror=i.onload=s,i.href=t,r?r.parentNode.insertBefore(i,r.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var o=r[a],i=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(i===e||i===t))return o}var s=document.getElementsByTagName("style");for(a=0;a<s.length;a++){o=s[a],i=o.getAttribute("data-href");if(i===e||i===t)return o}},a=function(a){return new Promise((function(o,i){var s=r.miniCssF(a),l=r.p+s;if(t(s,l))return o();e(a,l,null,o,i)}))},o={143:0};r.f.miniCss=function(e,t){var r={784:1};o[e]?t.push(o[e]):0!==o[e]&&r[e]&&t.push(o[e]=a(e).then((function(){o[e]=0}),(function(t){throw delete o[e],t})))}}}(),function(){var e={143:0};r.f.j=function(t,a){var o=r.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var i=new Promise((function(r,a){o=e[t]=[r,a]}));a.push(o[2]=i);var s=r.p+r.u(t),l=new Error,n=function(a){if(r.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var i=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",l.name="ChunkLoadError",l.type=i,l.request=s,o[1](l)}};r.l(s,n,"chunk-"+t,t)}},r.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,s=a[0],l=a[1],n=a[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(o in l)r.o(l,o)&&(r.m[o]=l[o]);if(n)var d=n(r)}for(t&&t(a);c<s.length;c++)i=s[c],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(d)},a=self["webpackChunkfinal_examination_vue"]=self["webpackChunkfinal_examination_vue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=r.O(void 0,[998],(function(){return r(4060)}));a=r.O(a)})();
//# sourceMappingURL=app.c2899464.js.map